geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# remove space between plot area and x axis
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
data
# string BP
data$BPcum <- NA
s <- 0
nbp <- c()
for (i in unique(data$CHR)){
nbp[i] <- max(data[data$CHR == i,]$BP)
data[data$CHR == i,"BPcum"] <- data[data$CHR == i,"BP"] + s
s <- s + nbp[i]
}
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle("Manhattan_Plot") +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
head(data)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
# show all points
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
# remove space between plot area and x axis
# add title and lables
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
# show all points
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
# remove space between plot area and x axis
# add title and lables
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("20_22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("20_22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
?pdf
pdf(file = "pval_manplot", sep="", height=6, width=12)
pdf(file = "pval_manplot", height=6, width=12)
plot
dev.off()
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("20_22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("20_22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("CHR20 CHR22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
remove(set1)
remove(set2)
remove(set3)
remove(set4)
remove(set5)
# using ggplot2 for GWAS
# load libraries
library(ggplot2)
library(dplyr)
# set working directory
setwd("/Users/dana.alhindi/Dropbox/UKB_Pigmentation")
# read in data
chr20_22 <- read.table(file="20_22_testfile.tsv", header=TRUE)
data <- chr20_22
head(data)
nrow(data)
# string BP
data$BPcum <- NA
s <- 0
nbp <- c()
for (i in unique(data$CHR)){
nbp[i] <- max(data[data$CHR == i,]$BP)
data[data$CHR == i,"BPcum"] <- data[data$CHR == i,"BP"] + s
s <- s + nbp[i]
}
head(data)
# -log10(PVAL) and bonferonni cut off
data$logp <- -log10(data$PVAL_META)
head(data)
bofferroni<- -log10(0.05/dim(data)[1])
axisdf = data %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
axisdf = data %>% group_by(CHR) %>% groups(center=( max(BPcum) + min(BPcum) ) / 2 )
axisdf = data %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
data<-data[!(data$PVAL_META==0),]
nrow(data)
# filter data so it can graph a little more easily
data <- filter(data, PVAL_META < 1e-4)
head(data)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
# show all points
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
# remove space between plot area and x axis
# add title and lables
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
head(data)
head(data)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("20_22 Manhattan Plot") +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) + geom_hline(yintercept=bofferroni, color = "red", size=.85) + geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) + scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) + scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) + scale_y_continuous(expand = c(0, 0) ) + ggtitle(paste("20_22 Manhattan Plot") + xlab("BP") + ylab("-log10(pvalue)") + theme_bw() + theme(legend.position="none", panel.border = element_blank(), panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank())
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) + geom_hline(yintercept=bofferroni, color = "red", size=.85) + geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) + scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) + scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) + scale_y_continuous(expand = c(0, 0) ) + ggtitle(paste("20_22 Manhattan Plot") + xlab("BP") + ylab("-log10(pvalue)") + theme_bw() + theme(legend.position="none", panel.border = element_blank(), panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank())
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) + geom_hline(yintercept=bofferroni, color = "red", size=.85) + geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) + scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) + scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) + scale_y_continuous(expand = c(0, 0) ) + ggtitle(paste("20_22 Manhattan Plot") + xlab("BP") + ylab("-log10(pvalue)")) + theme_bw() + theme(legend.position="none", panel.border = element_blank(), panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank())
head(data)
nrow(data)
# read in data
chr20_22 <- read.table(file="20_22_testfile.tsv", header=TRUE)
data <- chr20_22
head(data)
nrow(data)
# nCHR <- length(unique(data$CHR))
data$BPcum <- NA
s <- 0
nbp <- c()
for (i in unique(data$CHR)){
nbp[i] <- max(data[data$CHR == i,]$BP)
data[data$CHR == i,"BPcum"] <- data[data$CHR == i,"BP"] + s
s <- s + nbp[i]
}
head(data)
axisdf = data %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
# -log10(PVAL) and bonferonni cut off
data$logp <- -log10(data$PVAL_META)
bofferroni<- -log10(0.05/dim(data)[1])
head(data)
# filter data so it can graph a little more easily
data <- filter(data, PVAL_META < 1e-3)
nrow(data)
data<-data[!(data$PVAL_META==0),]
nrow(data)
head(data)
# plot
plot <- ggplot(data, aes(x=BPcum, y=-log10(PVAL_META))) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("CHR20 CHR22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
# plot
plot <- ggplot(data, aes(x=BPcum, y=logp)) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("CHR20 CHR22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
# read in data
chr20_22 <- read.table(file="20_22_testfile.tsv", header=TRUE)
data <- chr20_22
head(data)
nrow(data)
# nCHR <- length(unique(data$CHR))
data$BPcum <- NA
s <- 0
nbp <- c()
for (i in unique(data$CHR)){
nbp[i] <- max(data[data$CHR == i,]$BP)
data[data$CHR == i,"BPcum"] <- data[data$CHR == i,"BP"] + s
s <- s + nbp[i]
}
head(data)
axisdf = data %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
# -log10(PVAL) and bonferonni cut off
data$logp <- -log10(data$PVAL_META)
bofferroni<- -log10(0.05/dim(data)[1])
head(data)
# filter data so it can graph a little more easily
data <- filter(data, PVAL_META < 1e-3)
nrow(data)
data<-data[!(data$PVAL_META==0),]
nrow(data)
head(data)
# plot
plot <- ggplot(data, aes(x=BPcum, y=logp)) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("CHR20 CHR22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
plot
data <- chr20_22
head(data)
nrow(data)
# nCHR <- length(unique(data$CHR))
data$BPcum <- NA
s <- 0
nbp <- c()
for (i in unique(data$CHR)){
nbp[i] <- max(data[data$CHR == i,]$BP)
data[data$CHR == i,"BPcum"] <- data[data$CHR == i,"BP"] + s
s <- s + nbp[i]
}
head(data)
axisdf = data %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
# -log10(PVAL) and bonferonni cut off
data$logp <- -log10(data$PVAL_META)
bofferroni<- -log10(0.05/dim(data)[1])
head(data)
# filter data so it can graph a little more easily
data <- filter(data, PVAL_META < 1e-2)
nrow(data)
data<-data[!(data$PVAL_META==0),]
nrow(data)
head(data)
# plot
plot <- ggplot(data, aes(x=BPcum, y=logp)) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.85) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("CHR20 CHR22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
# plot
plot <- ggplot(data, aes(x=BPcum, y=logp)) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.65) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("CHR20 CHR22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
head(data)
# plot
plot <- ggplot(data, aes(x=BPcum, y=logp)) +
# add bofferroni cut off
geom_hline(yintercept=bofferroni, color = "red", size=.65) +
# show all points
geom_point( aes(color=as.factor(CHR)), alpha=0.4, size=1.3) +
scale_color_manual(values = rep(c("skyblue4", "mediumorchid"), 22 )) +
# custom X axis:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
# remove space between plot area and x axis
scale_y_continuous(expand = c(0, 0) ) +
# add title and lables
ggtitle(paste("CHR20 CHR22 Manhattan Plot")) +
xlab("BP") + ylab("-log10(pvalue)") +
# custom the theme:
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
plot
